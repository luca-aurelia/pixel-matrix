{"remainingRequest":"/Users/noisemachines/dev/pixel-matrix/node_modules/babel-loader/lib/index.js?{\"presets\":[[\"/Users/noisemachines/dev/pixel-matrix/node_modules/babel-preset-docz/dist/index.js\",{\"flow\":true,\"typescript\":false,\"parseProps\":true}]],\"plugins\":[[\"/Users/noisemachines/dev/pixel-matrix/node_modules/docz-utils/lib/named-asset-import.js\",{\"loaderMap\":{\"svg\":{\"ReactComponent\":\"@svgr/webpack?-prettier,-svgo![path]\"}}}]],\"babelrc\":false,\"cacheCompression\":true,\"compact\":true}!/Users/noisemachines/dev/pixel-matrix/built/PixelMatrix.js","dependencies":[{"path":"/Users/noisemachines/dev/pixel-matrix/built/PixelMatrix.js","mtime":1547774398797},{"path":"/Users/noisemachines/dev/pixel-matrix/node_modules/cache-loader/dist/cjs.js","mtime":1547744876783},{"path":"/Users/noisemachines/dev/pixel-matrix/node_modules/babel-loader/lib/index.js","mtime":1547744876677}],"contextDependencies":[],"result":["// RGB and HSL conversion utilities from\n// https://stackoverflow.com/questions/2353211/hsl-to-rgb-color-conversion\nvar to255=function to255(x){return Math.min(Math.floor(x*256),255);};var hue2rgb=function hue2rgb(p,q,t){if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p;};// RGBA is [0, 255]\n// HSLA is [0, 1]\nexport var toRgba=function toRgba(pixel){var r;var g;var b;var h=pixel.hue,s=pixel.saturation,l=pixel.lightness,a=pixel.alpha;if(s===0){r=g=b=l;}else{var q=l<0.5?l*(1+s):l+s-l*s;var p=2*l-q;r=hue2rgb(p,q,h+1/3);g=hue2rgb(p,q,h);b=hue2rgb(p,q,h-1/3);}var red=to255(r);var green=to255(g);var blue=to255(b);var alpha=to255(a);return{red:red,green:green,blue:blue,alpha:alpha};};export var toHsla=function toHsla(pixel){var r=pixel.red,g=pixel.green,b=pixel.blue,a=pixel.alpha;r/=255;g/=255;b/=255;a/=255;var max=Math.max(r,g,b);var min=Math.min(r,g,b);var middle=(max+min)/2;var h=middle;var s=middle;var l=middle;if(max===min){h=s=0;}else{var d=max-min;s=l>0.5?d/(2-max-min):d/(max+min);switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break;}h/=6;}return{hue:h,saturation:s,lightness:s,alpha:a};};var RGBA={channels:4};export var COLOR_PROFILES={RGBA:RGBA};var isEven=function isEven(n){return n%2===0;};var EMPTY_PIXEL={red:0,green:0,blue:0,alpha:255};export var vonNeumannOffsets=[{x:-1,y:0},{x:1,y:0},{x:0,y:-1},{x:0,y:1}];export var mooreOffsets=[];for(var x=-1;x<=1;x++){for(var y=-1;y<=1;y++){if(x===0&&y===0){continue;}mooreOffsets.push({x:x,y:y});}}var PixelMatrix=/** @class */function(){function PixelMatrix(width,height,pixels){this.width=width;this.height=height;var pixelsLength=width*height*this.colorProfile.channels;if(pixels===undefined){pixels=new Uint8ClampedArray(pixelsLength);}else{if(pixelsLength!==pixels.length){throw new Error(\"Expected pixels to have length \"+pixelsLength+\" (width * height * colorProfile.channels) but got \"+pixels.length+\" instead.\");}}this.pixels=pixels;}PixelMatrix.fromCanvas=function(canvas){var context=canvas.getContext('2d');var imageData=context.getImageData(0,0,canvas.width,canvas.height);return new PixelMatrix(canvas.width,canvas.height,imageData.data);};Object.defineProperty(PixelMatrix.prototype,\"pixelMatrix\",{get:function get(){if(!this._pixelMatrix){var pixelMatrix_1=new Array(this.width);this.forEach(function(pixel,point){if(!pixelMatrix_1[point.x])pixelMatrix_1[point.x]=[];pixelMatrix_1[point.x][point.y]=pixel;});this._pixelMatrix=pixelMatrix_1;}return this._pixelMatrix;},enumerable:true,configurable:true});Object.defineProperty(PixelMatrix.prototype,\"channels\",{get:function get(){return this.colorProfile.channels;},enumerable:true,configurable:true});Object.defineProperty(PixelMatrix.prototype,\"colorProfile\",{get:function get(){return RGBA;},enumerable:true,configurable:true});Object.defineProperty(PixelMatrix.prototype,\"shape\",{get:function get(){return[this.width,this.height];},enumerable:true,configurable:true});Object.defineProperty(PixelMatrix.prototype,\"countPixels\",{get:function get(){return this.width*this.height;},enumerable:true,configurable:true});PixelMatrix.prototype.get=function(point){if(!this.contains(point)){throw new Error(\"This pixel matrix doesn't contain the point \"+point+\".\");}var i=this.getIndex(point);var channels=[];for(var channelOffset=0;channelOffset<this.colorProfile.channels;channelOffset++){var channel=this.pixels[i+channelOffset];if(!channel)return EMPTY_PIXEL;channels.push(channel);}var red=channels[0],green=channels[1],blue=channels[2],alpha=channels[3];return{red:red,green:green,blue:blue,alpha:alpha};};PixelMatrix.prototype.getRandomPoint=function(){var x=Math.floor(Math.random()*this.width);var y=Math.floor(Math.random()*this.height);return{x:x,y:y};};PixelMatrix.prototype.getRandomPixel=function(){var randomPoint=this.getRandomPoint();return this.get(randomPoint);};PixelMatrix.prototype.getVonNeumannNeighboringPixels=function(point){return this.getNeighboringPixels(point,vonNeumannOffsets);};PixelMatrix.prototype.getVonNeumannNeighboringPoints=function(point){return this.getNeighbors(point,vonNeumannOffsets);};PixelMatrix.prototype.getMooreNeighboringPixels=function(point){return this.getNeighboringPixels(point,mooreOffsets);};PixelMatrix.prototype.getMooreNeighboringPoints=function(point){return this.getNeighbors(point,mooreOffsets);};PixelMatrix.prototype.getNeighboringPixels=function(point,neighborhood){var _this=this;return this.getNeighbors(point,neighborhood).map(function(neighbor){return _this.get(neighbor);});};PixelMatrix.prototype.getNeighbors=function(point,neighborhood){var _this=this;var neighbors=[];neighborhood.forEach(function(offset){var neighbor={x:point.x+offset.x,y:point.y+offset.y};if(_this.contains(neighbor)){neighbors.push(neighbor);}});return neighbors;};PixelMatrix.prototype.setHsla=function(point,pixel){this.set(point,toRgba(pixel));};PixelMatrix.prototype.set=function(point,pixel){var red=pixel.red,green=pixel.green,blue=pixel.blue,alpha=pixel.alpha;var i=this.getIndex(point);this.pixels[i]=red;this.pixels[i+1]=green;this.pixels[i+2]=blue;this.pixels[i+3]=alpha;this.pixelMatrix[point.x][point.y]=pixel;};PixelMatrix.prototype.randomDitherFrom=function(newMatrix,samples){var _this=this;if(samples===void 0){samples=1000;}var _loop_1=function _loop_1(_){var point=this_1.getRandomPoint();var newPixel=newMatrix.get(point);var p=newPixel;var darkeningFactor=0;if(Math.random()>0.5){p={red:p.red-darkeningFactor,green:p.green-darkeningFactor,blue:p.blue-darkeningFactor,alpha:255};}this_1.getVonNeumannNeighboringPoints(point).forEach(function(neighbor){_this.set(neighbor,p);});};var this_1=this;for(var _=0;_<samples;_++){_loop_1(_);}};PixelMatrix.prototype.getIndex=function(point){var x=point.x,y=point.y;if(!this.contains(point)){throw new Error(\"Expected x and y to be less than or equal to (\"+this.width+\", \"+this.height+\") but was actually (\"+x+\", \"+y+\")\");}return y*(this.width*this.channels)+x*this.channels;};PixelMatrix.prototype.forEach=function(fn){for(var y=0;y<this.height;y++){for(var x=0;x<this.width;x++){var point=Object.freeze({x:x,y:y});var pixel=this.get(point);fn(pixel,point,this);}}};PixelMatrix.prototype.map=function(fn){var newPixelMatrix=new PixelMatrix(this.width,this.height);this.forEach(function(pixel,point,pixelMatrix){var newPixel=fn(pixel,point,pixelMatrix);newPixelMatrix.set(point,newPixel);});return newPixelMatrix;};PixelMatrix.prototype.normalizedMap=function(fn){var _this=this;return this.map(function(pixel,point,pixelMatrix){var normalizedPoint={x:point.x/_this.width,y:point.y/_this.height};return fn(pixel,normalizedPoint,pixelMatrix);});};PixelMatrix.prototype.reduce=function(fn,startingValue){var total=startingValue;this.forEach(function(pixel,point){total=fn(total,pixel,point);});return total;};PixelMatrix.prototype.getWindow=function(center,width,height){if(isEven(width)){throw new Error(\"Expected an odd window width, but got \"+width);}if(isEven(height)){throw new Error(\"Expected an odd window height, but got \"+height);}var xRadius=(width-1)/2;var yRadius=(height-1)/2;var windowMatrix=new PixelMatrix(width,height);for(var yOffset=-yRadius;yOffset<=yRadius;yOffset++){for(var xOffset=-xRadius;xOffset<=xRadius;xOffset++){var x=center.x+xOffset;var y=center.y+yOffset;var point={x:x,y:y};var pixel=this.contains(point)?this.get(point):EMPTY_PIXEL;var pointInWindow={x:xOffset+xRadius,y:yOffset+yRadius};windowMatrix.set(pointInWindow,pixel);}}return windowMatrix;};PixelMatrix.prototype.contains=function(point){return point.x>=0&&point.x<this.width&&point.y>=0&&point.y<this.height;};PixelMatrix.prototype.toImageData=function(){return new ImageData(this.pixels,this.width,this.height);};PixelMatrix.prototype.putPixels=function(canvas){if(canvas.width!==this.width||canvas.height!==this.height){throw new Error(\"Expected canvas shape and PixelMatrix shape to be the same, but canvas shape was [\"+canvas.width+\", \"+canvas.height+\"] and PixelMatrix shape was \"+this.shape+\".\");}var context=canvas.getContext('2d');context.putImageData(this.toImageData(),0,0);};PixelMatrix.prototype.getCenter=function(){var x=Math.floor(this.width/2);var y=Math.floor(this.height/2);return{x:x,y:y};};return PixelMatrix;}();export default PixelMatrix;",{"version":3,"sources":["/Users/noisemachines/dev/pixel-matrix/built/PixelMatrix.js"],"names":["to255","x","Math","min","floor","hue2rgb","p","q","t","toRgba","pixel","r","g","b","h","hue","s","saturation","l","lightness","a","alpha","red","green","blue","toHsla","max","middle","d","RGBA","channels","COLOR_PROFILES","isEven","n","EMPTY_PIXEL","vonNeumannOffsets","y","mooreOffsets","push","PixelMatrix","width","height","pixels","pixelsLength","colorProfile","undefined","Uint8ClampedArray","length","Error","fromCanvas","canvas","context","getContext","imageData","getImageData","data","Object","defineProperty","prototype","get","_pixelMatrix","pixelMatrix_1","Array","forEach","point","enumerable","configurable","contains","i","getIndex","channelOffset","channel","getRandomPoint","random","getRandomPixel","randomPoint","getVonNeumannNeighboringPixels","getNeighboringPixels","getVonNeumannNeighboringPoints","getNeighbors","getMooreNeighboringPixels","getMooreNeighboringPoints","neighborhood","_this","map","neighbor","neighbors","offset","setHsla","set","pixelMatrix","randomDitherFrom","newMatrix","samples","_loop_1","_","this_1","newPixel","darkeningFactor","fn","freeze","newPixelMatrix","normalizedMap","normalizedPoint","reduce","startingValue","total","getWindow","center","xRadius","yRadius","windowMatrix","yOffset","xOffset","pointInWindow","toImageData","ImageData","putPixels","shape","putImageData","getCenter"],"mappings":"AAAA;AACA;AACA,GAAIA,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAAUC,CAAV,CAAa,CAAE,MAAOC,CAAAA,IAAI,CAACC,GAAL,CAASD,IAAI,CAACE,KAAL,CAAWH,CAAC,CAAG,GAAf,CAAT,CAA8B,GAA9B,CAAP,CAA4C,CAAvE,CACA,GAAII,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,CAAUC,CAAV,CAAaC,CAAb,CAAgBC,CAAhB,CAAmB,CAC7B,GAAIA,CAAC,CAAG,CAAR,CACIA,CAAC,EAAI,CAAL,CACJ,GAAIA,CAAC,CAAG,CAAR,CACIA,CAAC,EAAI,CAAL,CACJ,GAAIA,CAAC,CAAG,EAAI,CAAZ,CACI,MAAOF,CAAAA,CAAC,CAAG,CAACC,CAAC,CAAGD,CAAL,EAAU,CAAV,CAAcE,CAAzB,CACJ,GAAIA,CAAC,CAAG,EAAI,CAAZ,CACI,MAAOD,CAAAA,CAAP,CACJ,GAAIC,CAAC,CAAG,EAAI,CAAZ,CACI,MAAOF,CAAAA,CAAC,CAAG,CAACC,CAAC,CAAGD,CAAL,GAAW,EAAI,CAAJ,CAAQE,CAAnB,EAAwB,CAAnC,CACJ,MAAOF,CAAAA,CAAP,CACH,CAZD,CAaA;AACA;AACA,MAAO,IAAIG,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAAUC,KAAV,CAAiB,CACjC,GAAIC,CAAAA,CAAJ,CACA,GAAIC,CAAAA,CAAJ,CACA,GAAIC,CAAAA,CAAJ,CACA,GAAIC,CAAAA,CAAC,CAAGJ,KAAK,CAACK,GAAd,CAAmBC,CAAC,CAAGN,KAAK,CAACO,UAA7B,CAAyCC,CAAC,CAAGR,KAAK,CAACS,SAAnD,CAA8DC,CAAC,CAAGV,KAAK,CAACW,KAAxE,CACA,GAAIL,CAAC,GAAK,CAAV,CAAa,CACTL,CAAC,CAAGC,CAAC,CAAGC,CAAC,CAAGK,CAAZ,CACH,CAFD,IAGK,CACD,GAAIX,CAAAA,CAAC,CAAGW,CAAC,CAAG,GAAJ,CAAUA,CAAC,EAAI,EAAIF,CAAR,CAAX,CAAwBE,CAAC,CAAGF,CAAJ,CAAQE,CAAC,CAAGF,CAA5C,CACA,GAAIV,CAAAA,CAAC,CAAG,EAAIY,CAAJ,CAAQX,CAAhB,CACAI,CAAC,CAAGN,OAAO,CAACC,CAAD,CAAIC,CAAJ,CAAOO,CAAC,CAAG,EAAI,CAAf,CAAX,CACAF,CAAC,CAAGP,OAAO,CAACC,CAAD,CAAIC,CAAJ,CAAOO,CAAP,CAAX,CACAD,CAAC,CAAGR,OAAO,CAACC,CAAD,CAAIC,CAAJ,CAAOO,CAAC,CAAG,EAAI,CAAf,CAAX,CACH,CACD,GAAIQ,CAAAA,GAAG,CAAGtB,KAAK,CAACW,CAAD,CAAf,CACA,GAAIY,CAAAA,KAAK,CAAGvB,KAAK,CAACY,CAAD,CAAjB,CACA,GAAIY,CAAAA,IAAI,CAAGxB,KAAK,CAACa,CAAD,CAAhB,CACA,GAAIQ,CAAAA,KAAK,CAAGrB,KAAK,CAACoB,CAAD,CAAjB,CACA,MAAO,CAAEE,GAAG,CAAEA,GAAP,CAAYC,KAAK,CAAEA,KAAnB,CAA0BC,IAAI,CAAEA,IAAhC,CAAsCH,KAAK,CAAEA,KAA7C,CAAP,CACH,CApBM,CAqBP,MAAO,IAAII,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAAUf,KAAV,CAAiB,CACjC,GAAIC,CAAAA,CAAC,CAAGD,KAAK,CAACY,GAAd,CAAmBV,CAAC,CAAGF,KAAK,CAACa,KAA7B,CAAoCV,CAAC,CAAGH,KAAK,CAACc,IAA9C,CAAoDJ,CAAC,CAAGV,KAAK,CAACW,KAA9D,CACAV,CAAC,EAAI,GAAL,CACAC,CAAC,EAAI,GAAL,CACAC,CAAC,EAAI,GAAL,CACAO,CAAC,EAAI,GAAL,CACA,GAAIM,CAAAA,GAAG,CAAGxB,IAAI,CAACwB,GAAL,CAASf,CAAT,CAAYC,CAAZ,CAAeC,CAAf,CAAV,CACA,GAAIV,CAAAA,GAAG,CAAGD,IAAI,CAACC,GAAL,CAASQ,CAAT,CAAYC,CAAZ,CAAeC,CAAf,CAAV,CACA,GAAIc,CAAAA,MAAM,CAAG,CAACD,GAAG,CAAGvB,GAAP,EAAc,CAA3B,CACA,GAAIW,CAAAA,CAAC,CAAGa,MAAR,CACA,GAAIX,CAAAA,CAAC,CAAGW,MAAR,CACA,GAAIT,CAAAA,CAAC,CAAGS,MAAR,CACA,GAAID,GAAG,GAAKvB,GAAZ,CAAiB,CACbW,CAAC,CAAGE,CAAC,CAAG,CAAR,CACH,CAFD,IAGK,CACD,GAAIY,CAAAA,CAAC,CAAGF,GAAG,CAAGvB,GAAd,CACAa,CAAC,CAAGE,CAAC,CAAG,GAAJ,CAAUU,CAAC,EAAI,EAAIF,GAAJ,CAAUvB,GAAd,CAAX,CAAgCyB,CAAC,EAAIF,GAAG,CAAGvB,GAAV,CAArC,CACA,OAAQuB,GAAR,EACI,IAAKf,CAAAA,CAAL,CACIG,CAAC,CAAG,CAACF,CAAC,CAAGC,CAAL,EAAUe,CAAV,EAAehB,CAAC,CAAGC,CAAJ,CAAQ,CAAR,CAAY,CAA3B,CAAJ,CACA,MACJ,IAAKD,CAAAA,CAAL,CACIE,CAAC,CAAG,CAACD,CAAC,CAAGF,CAAL,EAAUiB,CAAV,CAAc,CAAlB,CACA,MACJ,IAAKf,CAAAA,CAAL,CACIC,CAAC,CAAG,CAACH,CAAC,CAAGC,CAAL,EAAUgB,CAAV,CAAc,CAAlB,CACA,MATR,CAWAd,CAAC,EAAI,CAAL,CACH,CACD,MAAO,CAAEC,GAAG,CAAED,CAAP,CAAUG,UAAU,CAAED,CAAtB,CAAyBG,SAAS,CAAEH,CAApC,CAAuCK,KAAK,CAAED,CAA9C,CAAP,CACH,CAhCM,CAiCP,GAAIS,CAAAA,IAAI,CAAG,CACPC,QAAQ,CAAE,CADH,CAAX,CAGA,MAAO,IAAIC,CAAAA,cAAc,CAAG,CACxBF,IAAI,CAAEA,IADkB,CAArB,CAGP,GAAIG,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAAUC,CAAV,CAAa,CAAE,MAAOA,CAAAA,CAAC,CAAG,CAAJ,GAAU,CAAjB,CAAqB,CAAjD,CACA,GAAIC,CAAAA,WAAW,CAAG,CACdZ,GAAG,CAAE,CADS,CAEdC,KAAK,CAAE,CAFO,CAGdC,IAAI,CAAE,CAHQ,CAIdH,KAAK,CAAE,GAJO,CAAlB,CAMA,MAAO,IAAIc,CAAAA,iBAAiB,CAAG,CAC3B,CAAElC,CAAC,CAAE,CAAC,CAAN,CAASmC,CAAC,CAAE,CAAZ,CAD2B,CAE3B,CAAEnC,CAAC,CAAE,CAAL,CAAQmC,CAAC,CAAE,CAAX,CAF2B,CAG3B,CAAEnC,CAAC,CAAE,CAAL,CAAQmC,CAAC,CAAE,CAAC,CAAZ,CAH2B,CAI3B,CAAEnC,CAAC,CAAE,CAAL,CAAQmC,CAAC,CAAE,CAAX,CAJ2B,CAAxB,CAMP,MAAO,IAAIC,CAAAA,YAAY,CAAG,EAAnB,CACP,IAAK,GAAIpC,CAAAA,CAAC,CAAG,CAAC,CAAd,CAAiBA,CAAC,EAAI,CAAtB,CAAyBA,CAAC,EAA1B,CAA8B,CAC1B,IAAK,GAAImC,CAAAA,CAAC,CAAG,CAAC,CAAd,CAAiBA,CAAC,EAAI,CAAtB,CAAyBA,CAAC,EAA1B,CAA8B,CAC1B,GAAInC,CAAC,GAAK,CAAN,EAAWmC,CAAC,GAAK,CAArB,CAAwB,CACpB,SACH,CACDC,YAAY,CAACC,IAAb,CAAkB,CAAErC,CAAC,CAAEA,CAAL,CAAQmC,CAAC,CAAEA,CAAX,CAAlB,EACH,CACJ,CACD,GAAIG,CAAAA,WAAW,CAAG,aAAe,UAAY,CACzC,QAASA,CAAAA,WAAT,CAAqBC,KAArB,CAA4BC,MAA5B,CAAoCC,MAApC,CAA4C,CACxC,KAAKF,KAAL,CAAaA,KAAb,CACA,KAAKC,MAAL,CAAcA,MAAd,CACA,GAAIE,CAAAA,YAAY,CAAGH,KAAK,CAAGC,MAAR,CAAiB,KAAKG,YAAL,CAAkBd,QAAtD,CACA,GAAIY,MAAM,GAAKG,SAAf,CAA0B,CACtBH,MAAM,CAAG,GAAII,CAAAA,iBAAJ,CAAsBH,YAAtB,CAAT,CACH,CAFD,IAGK,CACD,GAAIA,YAAY,GAAKD,MAAM,CAACK,MAA5B,CAAoC,CAChC,KAAM,IAAIC,CAAAA,KAAJ,CAAU,kCAAoCL,YAApC,CAAmD,oDAAnD,CAA0GD,MAAM,CAACK,MAAjH,CAA0H,WAApI,CAAN,CACH,CACJ,CACD,KAAKL,MAAL,CAAcA,MAAd,CACH,CACDH,WAAW,CAACU,UAAZ,CAAyB,SAAUC,MAAV,CAAkB,CACvC,GAAIC,CAAAA,OAAO,CAAGD,MAAM,CAACE,UAAP,CAAkB,IAAlB,CAAd,CACA,GAAIC,CAAAA,SAAS,CAAGF,OAAO,CAACG,YAAR,CAAqB,CAArB,CAAwB,CAAxB,CAA2BJ,MAAM,CAACV,KAAlC,CAAyCU,MAAM,CAACT,MAAhD,CAAhB,CACA,MAAO,IAAIF,CAAAA,WAAJ,CAAgBW,MAAM,CAACV,KAAvB,CAA8BU,MAAM,CAACT,MAArC,CAA6CY,SAAS,CAACE,IAAvD,CAAP,CACH,CAJD,CAKAC,MAAM,CAACC,cAAP,CAAsBlB,WAAW,CAACmB,SAAlC,CAA6C,aAA7C,CAA4D,CACxDC,GAAG,CAAE,cAAY,CACb,GAAI,CAAC,KAAKC,YAAV,CAAwB,CACpB,GAAIC,CAAAA,aAAa,CAAG,GAAIC,CAAAA,KAAJ,CAAU,KAAKtB,KAAf,CAApB,CACA,KAAKuB,OAAL,CAAa,SAAUrD,KAAV,CAAiBsD,KAAjB,CAAwB,CACjC,GAAI,CAACH,aAAa,CAACG,KAAK,CAAC/D,CAAP,CAAlB,CACI4D,aAAa,CAACG,KAAK,CAAC/D,CAAP,CAAb,CAAyB,EAAzB,CACJ4D,aAAa,CAACG,KAAK,CAAC/D,CAAP,CAAb,CAAuB+D,KAAK,CAAC5B,CAA7B,EAAkC1B,KAAlC,CACH,CAJD,EAKA,KAAKkD,YAAL,CAAoBC,aAApB,CACH,CACD,MAAO,MAAKD,YAAZ,CACH,CAZuD,CAaxDK,UAAU,CAAE,IAb4C,CAcxDC,YAAY,CAAE,IAd0C,CAA5D,EAgBAV,MAAM,CAACC,cAAP,CAAsBlB,WAAW,CAACmB,SAAlC,CAA6C,UAA7C,CAAyD,CACrDC,GAAG,CAAE,cAAY,CACb,MAAO,MAAKf,YAAL,CAAkBd,QAAzB,CACH,CAHoD,CAIrDmC,UAAU,CAAE,IAJyC,CAKrDC,YAAY,CAAE,IALuC,CAAzD,EAOAV,MAAM,CAACC,cAAP,CAAsBlB,WAAW,CAACmB,SAAlC,CAA6C,cAA7C,CAA6D,CACzDC,GAAG,CAAE,cAAY,CACb,MAAO9B,CAAAA,IAAP,CACH,CAHwD,CAIzDoC,UAAU,CAAE,IAJ6C,CAKzDC,YAAY,CAAE,IAL2C,CAA7D,EAOAV,MAAM,CAACC,cAAP,CAAsBlB,WAAW,CAACmB,SAAlC,CAA6C,OAA7C,CAAsD,CAClDC,GAAG,CAAE,cAAY,CACb,MAAO,CAAC,KAAKnB,KAAN,CAAa,KAAKC,MAAlB,CAAP,CACH,CAHiD,CAIlDwB,UAAU,CAAE,IAJsC,CAKlDC,YAAY,CAAE,IALoC,CAAtD,EAOAV,MAAM,CAACC,cAAP,CAAsBlB,WAAW,CAACmB,SAAlC,CAA6C,aAA7C,CAA4D,CACxDC,GAAG,CAAE,cAAY,CACb,MAAO,MAAKnB,KAAL,CAAa,KAAKC,MAAzB,CACH,CAHuD,CAIxDwB,UAAU,CAAE,IAJ4C,CAKxDC,YAAY,CAAE,IAL0C,CAA5D,EAOA3B,WAAW,CAACmB,SAAZ,CAAsBC,GAAtB,CAA4B,SAAUK,KAAV,CAAiB,CACzC,GAAI,CAAC,KAAKG,QAAL,CAAcH,KAAd,CAAL,CAA2B,CACvB,KAAM,IAAIhB,CAAAA,KAAJ,CAAU,+CAAiDgB,KAAjD,CAAyD,GAAnE,CAAN,CACH,CACD,GAAII,CAAAA,CAAC,CAAG,KAAKC,QAAL,CAAcL,KAAd,CAAR,CACA,GAAIlC,CAAAA,QAAQ,CAAG,EAAf,CACA,IAAK,GAAIwC,CAAAA,aAAa,CAAG,CAAzB,CAA4BA,aAAa,CAAG,KAAK1B,YAAL,CAAkBd,QAA9D,CAAwEwC,aAAa,EAArF,CAAyF,CACrF,GAAIC,CAAAA,OAAO,CAAG,KAAK7B,MAAL,CAAY0B,CAAC,CAAGE,aAAhB,CAAd,CACA,GAAI,CAACC,OAAL,CACI,MAAOrC,CAAAA,WAAP,CACJJ,QAAQ,CAACQ,IAAT,CAAciC,OAAd,EACH,CACD,GAAIjD,CAAAA,GAAG,CAAGQ,QAAQ,CAAC,CAAD,CAAlB,CAAuBP,KAAK,CAAGO,QAAQ,CAAC,CAAD,CAAvC,CAA4CN,IAAI,CAAGM,QAAQ,CAAC,CAAD,CAA3D,CAAgET,KAAK,CAAGS,QAAQ,CAAC,CAAD,CAAhF,CACA,MAAO,CAAER,GAAG,CAAEA,GAAP,CAAYC,KAAK,CAAEA,KAAnB,CAA0BC,IAAI,CAAEA,IAAhC,CAAsCH,KAAK,CAAEA,KAA7C,CAAP,CACH,CAdD,CAeAkB,WAAW,CAACmB,SAAZ,CAAsBc,cAAtB,CAAuC,UAAY,CAC/C,GAAIvE,CAAAA,CAAC,CAAGC,IAAI,CAACE,KAAL,CAAWF,IAAI,CAACuE,MAAL,GAAgB,KAAKjC,KAAhC,CAAR,CACA,GAAIJ,CAAAA,CAAC,CAAGlC,IAAI,CAACE,KAAL,CAAWF,IAAI,CAACuE,MAAL,GAAgB,KAAKhC,MAAhC,CAAR,CACA,MAAO,CAAExC,CAAC,CAAEA,CAAL,CAAQmC,CAAC,CAAEA,CAAX,CAAP,CACH,CAJD,CAKAG,WAAW,CAACmB,SAAZ,CAAsBgB,cAAtB,CAAuC,UAAY,CAC/C,GAAIC,CAAAA,WAAW,CAAG,KAAKH,cAAL,EAAlB,CACA,MAAO,MAAKb,GAAL,CAASgB,WAAT,CAAP,CACH,CAHD,CAIApC,WAAW,CAACmB,SAAZ,CAAsBkB,8BAAtB,CAAuD,SAAUZ,KAAV,CAAiB,CACpE,MAAO,MAAKa,oBAAL,CAA0Bb,KAA1B,CAAiC7B,iBAAjC,CAAP,CACH,CAFD,CAGAI,WAAW,CAACmB,SAAZ,CAAsBoB,8BAAtB,CAAuD,SAAUd,KAAV,CAAiB,CACpE,MAAO,MAAKe,YAAL,CAAkBf,KAAlB,CAAyB7B,iBAAzB,CAAP,CACH,CAFD,CAGAI,WAAW,CAACmB,SAAZ,CAAsBsB,yBAAtB,CAAkD,SAAUhB,KAAV,CAAiB,CAC/D,MAAO,MAAKa,oBAAL,CAA0Bb,KAA1B,CAAiC3B,YAAjC,CAAP,CACH,CAFD,CAGAE,WAAW,CAACmB,SAAZ,CAAsBuB,yBAAtB,CAAkD,SAAUjB,KAAV,CAAiB,CAC/D,MAAO,MAAKe,YAAL,CAAkBf,KAAlB,CAAyB3B,YAAzB,CAAP,CACH,CAFD,CAGAE,WAAW,CAACmB,SAAZ,CAAsBmB,oBAAtB,CAA6C,SAAUb,KAAV,CAAiBkB,YAAjB,CAA+B,CACxE,GAAIC,CAAAA,KAAK,CAAG,IAAZ,CACA,MAAO,MAAKJ,YAAL,CAAkBf,KAAlB,CAAyBkB,YAAzB,EAAuCE,GAAvC,CAA2C,SAAUC,QAAV,CAAoB,CAClE,MAAOF,CAAAA,KAAK,CAACxB,GAAN,CAAU0B,QAAV,CAAP,CACH,CAFM,CAAP,CAGH,CALD,CAMA9C,WAAW,CAACmB,SAAZ,CAAsBqB,YAAtB,CAAqC,SAAUf,KAAV,CAAiBkB,YAAjB,CAA+B,CAChE,GAAIC,CAAAA,KAAK,CAAG,IAAZ,CACA,GAAIG,CAAAA,SAAS,CAAG,EAAhB,CACAJ,YAAY,CAACnB,OAAb,CAAqB,SAAUwB,MAAV,CAAkB,CACnC,GAAIF,CAAAA,QAAQ,CAAG,CACXpF,CAAC,CAAE+D,KAAK,CAAC/D,CAAN,CAAUsF,MAAM,CAACtF,CADT,CAEXmC,CAAC,CAAE4B,KAAK,CAAC5B,CAAN,CAAUmD,MAAM,CAACnD,CAFT,CAAf,CAIA,GAAI+C,KAAK,CAAChB,QAAN,CAAekB,QAAf,CAAJ,CAA8B,CAC1BC,SAAS,CAAChD,IAAV,CAAe+C,QAAf,EACH,CACJ,CARD,EASA,MAAOC,CAAAA,SAAP,CACH,CAbD,CAcA/C,WAAW,CAACmB,SAAZ,CAAsB8B,OAAtB,CAAgC,SAAUxB,KAAV,CAAiBtD,KAAjB,CAAwB,CACpD,KAAK+E,GAAL,CAASzB,KAAT,CAAgBvD,MAAM,CAACC,KAAD,CAAtB,EACH,CAFD,CAGA6B,WAAW,CAACmB,SAAZ,CAAsB+B,GAAtB,CAA4B,SAAUzB,KAAV,CAAiBtD,KAAjB,CAAwB,CAChD,GAAIY,CAAAA,GAAG,CAAGZ,KAAK,CAACY,GAAhB,CAAqBC,KAAK,CAAGb,KAAK,CAACa,KAAnC,CAA0CC,IAAI,CAAGd,KAAK,CAACc,IAAvD,CAA6DH,KAAK,CAAGX,KAAK,CAACW,KAA3E,CACA,GAAI+C,CAAAA,CAAC,CAAG,KAAKC,QAAL,CAAcL,KAAd,CAAR,CACA,KAAKtB,MAAL,CAAY0B,CAAZ,EAAiB9C,GAAjB,CACA,KAAKoB,MAAL,CAAY0B,CAAC,CAAG,CAAhB,EAAqB7C,KAArB,CACA,KAAKmB,MAAL,CAAY0B,CAAC,CAAG,CAAhB,EAAqB5C,IAArB,CACA,KAAKkB,MAAL,CAAY0B,CAAC,CAAG,CAAhB,EAAqB/C,KAArB,CACA,KAAKqE,WAAL,CAAiB1B,KAAK,CAAC/D,CAAvB,EAA0B+D,KAAK,CAAC5B,CAAhC,EAAqC1B,KAArC,CACH,CARD,CASA6B,WAAW,CAACmB,SAAZ,CAAsBiC,gBAAtB,CAAyC,SAAUC,SAAV,CAAqBC,OAArB,CAA8B,CACnE,GAAIV,CAAAA,KAAK,CAAG,IAAZ,CACA,GAAIU,OAAO,GAAK,IAAK,EAArB,CAAwB,CAAEA,OAAO,CAAG,IAAV,CAAiB,CAC3C,GAAIC,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,CAAUC,CAAV,CAAa,CACvB,GAAI/B,CAAAA,KAAK,CAAGgC,MAAM,CAACxB,cAAP,EAAZ,CACA,GAAIyB,CAAAA,QAAQ,CAAGL,SAAS,CAACjC,GAAV,CAAcK,KAAd,CAAf,CACA,GAAI1D,CAAAA,CAAC,CAAG2F,QAAR,CACA,GAAIC,CAAAA,eAAe,CAAG,CAAtB,CACA,GAAIhG,IAAI,CAACuE,MAAL,GAAgB,GAApB,CAAyB,CACrBnE,CAAC,CAAG,CACAgB,GAAG,CAAEhB,CAAC,CAACgB,GAAF,CAAQ4E,eADb,CAEA3E,KAAK,CAAEjB,CAAC,CAACiB,KAAF,CAAU2E,eAFjB,CAGA1E,IAAI,CAAElB,CAAC,CAACkB,IAAF,CAAS0E,eAHf,CAIA7E,KAAK,CAAE,GAJP,CAAJ,CAMH,CACD2E,MAAM,CAAClB,8BAAP,CAAsCd,KAAtC,EAA6CD,OAA7C,CAAqD,SAAUsB,QAAV,CAAoB,CACrEF,KAAK,CAACM,GAAN,CAAUJ,QAAV,CAAoB/E,CAApB,EACH,CAFD,EAGH,CAhBD,CAiBA,GAAI0F,CAAAA,MAAM,CAAG,IAAb,CACA,IAAK,GAAID,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGF,OAApB,CAA6BE,CAAC,EAA9B,CAAkC,CAC9BD,OAAO,CAACC,CAAD,CAAP,CACH,CACJ,CAxBD,CAyBAxD,WAAW,CAACmB,SAAZ,CAAsBW,QAAtB,CAAiC,SAAUL,KAAV,CAAiB,CAC9C,GAAI/D,CAAAA,CAAC,CAAG+D,KAAK,CAAC/D,CAAd,CAAiBmC,CAAC,CAAG4B,KAAK,CAAC5B,CAA3B,CACA,GAAI,CAAC,KAAK+B,QAAL,CAAcH,KAAd,CAAL,CAA2B,CACvB,KAAM,IAAIhB,CAAAA,KAAJ,CAAU,iDAAmD,KAAKR,KAAxD,CAAgE,IAAhE,CAAuE,KAAKC,MAA5E,CAAqF,sBAArF,CAA8GxC,CAA9G,CAAkH,IAAlH,CAAyHmC,CAAzH,CAA6H,GAAvI,CAAN,CACH,CACD,MAAOA,CAAAA,CAAC,EAAI,KAAKI,KAAL,CAAa,KAAKV,QAAtB,CAAD,CAAmC7B,CAAC,CAAG,KAAK6B,QAAnD,CACH,CAND,CAOAS,WAAW,CAACmB,SAAZ,CAAsBK,OAAtB,CAAgC,SAAUoC,EAAV,CAAc,CAC1C,IAAK,GAAI/D,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,KAAKK,MAAzB,CAAiCL,CAAC,EAAlC,CAAsC,CAClC,IAAK,GAAInC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAG,KAAKuC,KAAzB,CAAgCvC,CAAC,EAAjC,CAAqC,CACjC,GAAI+D,CAAAA,KAAK,CAAGR,MAAM,CAAC4C,MAAP,CAAc,CAAEnG,CAAC,CAAEA,CAAL,CAAQmC,CAAC,CAAEA,CAAX,CAAd,CAAZ,CACA,GAAI1B,CAAAA,KAAK,CAAG,KAAKiD,GAAL,CAASK,KAAT,CAAZ,CACAmC,EAAE,CAACzF,KAAD,CAAQsD,KAAR,CAAe,IAAf,CAAF,CACH,CACJ,CACJ,CARD,CASAzB,WAAW,CAACmB,SAAZ,CAAsB0B,GAAtB,CAA4B,SAAUe,EAAV,CAAc,CACtC,GAAIE,CAAAA,cAAc,CAAG,GAAI9D,CAAAA,WAAJ,CAAgB,KAAKC,KAArB,CAA4B,KAAKC,MAAjC,CAArB,CACA,KAAKsB,OAAL,CAAa,SAAUrD,KAAV,CAAiBsD,KAAjB,CAAwB0B,WAAxB,CAAqC,CAC9C,GAAIO,CAAAA,QAAQ,CAAGE,EAAE,CAACzF,KAAD,CAAQsD,KAAR,CAAe0B,WAAf,CAAjB,CACAW,cAAc,CAACZ,GAAf,CAAmBzB,KAAnB,CAA0BiC,QAA1B,EACH,CAHD,EAIA,MAAOI,CAAAA,cAAP,CACH,CAPD,CAQA9D,WAAW,CAACmB,SAAZ,CAAsB4C,aAAtB,CAAsC,SAAUH,EAAV,CAAc,CAChD,GAAIhB,CAAAA,KAAK,CAAG,IAAZ,CACA,MAAO,MAAKC,GAAL,CAAS,SAAU1E,KAAV,CAAiBsD,KAAjB,CAAwB0B,WAAxB,CAAqC,CACjD,GAAIa,CAAAA,eAAe,CAAG,CAClBtG,CAAC,CAAE+D,KAAK,CAAC/D,CAAN,CAAUkF,KAAK,CAAC3C,KADD,CAElBJ,CAAC,CAAE4B,KAAK,CAAC5B,CAAN,CAAU+C,KAAK,CAAC1C,MAFD,CAAtB,CAIA,MAAO0D,CAAAA,EAAE,CAACzF,KAAD,CAAQ6F,eAAR,CAAyBb,WAAzB,CAAT,CACH,CANM,CAAP,CAOH,CATD,CAUAnD,WAAW,CAACmB,SAAZ,CAAsB8C,MAAtB,CAA+B,SAAUL,EAAV,CAAcM,aAAd,CAA6B,CACxD,GAAIC,CAAAA,KAAK,CAAGD,aAAZ,CACA,KAAK1C,OAAL,CAAa,SAAUrD,KAAV,CAAiBsD,KAAjB,CAAwB,CACjC0C,KAAK,CAAGP,EAAE,CAACO,KAAD,CAAQhG,KAAR,CAAesD,KAAf,CAAV,CACH,CAFD,EAGA,MAAO0C,CAAAA,KAAP,CACH,CAND,CAOAnE,WAAW,CAACmB,SAAZ,CAAsBiD,SAAtB,CAAkC,SAAUC,MAAV,CAAkBpE,KAAlB,CAAyBC,MAAzB,CAAiC,CAC/D,GAAIT,MAAM,CAACQ,KAAD,CAAV,CAAmB,CACf,KAAM,IAAIQ,CAAAA,KAAJ,CAAU,yCAA2CR,KAArD,CAAN,CACH,CACD,GAAIR,MAAM,CAACS,MAAD,CAAV,CAAoB,CAChB,KAAM,IAAIO,CAAAA,KAAJ,CAAU,0CAA4CP,MAAtD,CAAN,CACH,CACD,GAAIoE,CAAAA,OAAO,CAAG,CAACrE,KAAK,CAAG,CAAT,EAAc,CAA5B,CACA,GAAIsE,CAAAA,OAAO,CAAG,CAACrE,MAAM,CAAG,CAAV,EAAe,CAA7B,CACA,GAAIsE,CAAAA,YAAY,CAAG,GAAIxE,CAAAA,WAAJ,CAAgBC,KAAhB,CAAuBC,MAAvB,CAAnB,CACA,IAAK,GAAIuE,CAAAA,OAAO,CAAG,CAACF,OAApB,CAA6BE,OAAO,EAAIF,OAAxC,CAAiDE,OAAO,EAAxD,CAA4D,CACxD,IAAK,GAAIC,CAAAA,OAAO,CAAG,CAACJ,OAApB,CAA6BI,OAAO,EAAIJ,OAAxC,CAAiDI,OAAO,EAAxD,CAA4D,CACxD,GAAIhH,CAAAA,CAAC,CAAG2G,MAAM,CAAC3G,CAAP,CAAWgH,OAAnB,CACA,GAAI7E,CAAAA,CAAC,CAAGwE,MAAM,CAACxE,CAAP,CAAW4E,OAAnB,CACA,GAAIhD,CAAAA,KAAK,CAAG,CAAE/D,CAAC,CAAEA,CAAL,CAAQmC,CAAC,CAAEA,CAAX,CAAZ,CACA,GAAI1B,CAAAA,KAAK,CAAG,KAAKyD,QAAL,CAAcH,KAAd,EAAuB,KAAKL,GAAL,CAASK,KAAT,CAAvB,CAAyC9B,WAArD,CACA,GAAIgF,CAAAA,aAAa,CAAG,CAAEjH,CAAC,CAAEgH,OAAO,CAAGJ,OAAf,CAAwBzE,CAAC,CAAE4E,OAAO,CAAGF,OAArC,CAApB,CACAC,YAAY,CAACtB,GAAb,CAAiByB,aAAjB,CAAgCxG,KAAhC,EACH,CACJ,CACD,MAAOqG,CAAAA,YAAP,CACH,CArBD,CAsBAxE,WAAW,CAACmB,SAAZ,CAAsBS,QAAtB,CAAiC,SAAUH,KAAV,CAAiB,CAC9C,MAAQA,CAAAA,KAAK,CAAC/D,CAAN,EAAW,CAAX,EACJ+D,KAAK,CAAC/D,CAAN,CAAU,KAAKuC,KADX,EAEJwB,KAAK,CAAC5B,CAAN,EAAW,CAFP,EAGJ4B,KAAK,CAAC5B,CAAN,CAAU,KAAKK,MAHnB,CAIH,CALD,CAMAF,WAAW,CAACmB,SAAZ,CAAsByD,WAAtB,CAAoC,UAAY,CAC5C,MAAO,IAAIC,CAAAA,SAAJ,CAAc,KAAK1E,MAAnB,CAA2B,KAAKF,KAAhC,CAAuC,KAAKC,MAA5C,CAAP,CACH,CAFD,CAGAF,WAAW,CAACmB,SAAZ,CAAsB2D,SAAtB,CAAkC,SAAUnE,MAAV,CAAkB,CAChD,GAAIA,MAAM,CAACV,KAAP,GAAiB,KAAKA,KAAtB,EAA+BU,MAAM,CAACT,MAAP,GAAkB,KAAKA,MAA1D,CAAkE,CAC9D,KAAM,IAAIO,CAAAA,KAAJ,CAAU,qFAAuFE,MAAM,CAACV,KAA9F,CAAsG,IAAtG,CAA6GU,MAAM,CAACT,MAApH,CAA6H,8BAA7H,CAA8J,KAAK6E,KAAnK,CAA2K,GAArL,CAAN,CACH,CACD,GAAInE,CAAAA,OAAO,CAAGD,MAAM,CAACE,UAAP,CAAkB,IAAlB,CAAd,CACAD,OAAO,CAACoE,YAAR,CAAqB,KAAKJ,WAAL,EAArB,CAAyC,CAAzC,CAA4C,CAA5C,EACH,CAND,CAOA5E,WAAW,CAACmB,SAAZ,CAAsB8D,SAAtB,CAAkC,UAAY,CAC1C,GAAIvH,CAAAA,CAAC,CAAGC,IAAI,CAACE,KAAL,CAAW,KAAKoC,KAAL,CAAa,CAAxB,CAAR,CACA,GAAIJ,CAAAA,CAAC,CAAGlC,IAAI,CAACE,KAAL,CAAW,KAAKqC,MAAL,CAAc,CAAzB,CAAR,CACA,MAAO,CAAExC,CAAC,CAAEA,CAAL,CAAQmC,CAAC,CAAEA,CAAX,CAAP,CACH,CAJD,CAKA,MAAOG,CAAAA,WAAP,CACH,CAlPgC,EAAjC,CAmPA,cAAeA,CAAAA,WAAf","sourcesContent":["// RGB and HSL conversion utilities from\n// https://stackoverflow.com/questions/2353211/hsl-to-rgb-color-conversion\nvar to255 = function (x) { return Math.min(Math.floor(x * 256), 255); };\nvar hue2rgb = function (p, q, t) {\n    if (t < 0)\n        t += 1;\n    if (t > 1)\n        t -= 1;\n    if (t < 1 / 6)\n        return p + (q - p) * 6 * t;\n    if (t < 1 / 2)\n        return q;\n    if (t < 2 / 3)\n        return p + (q - p) * (2 / 3 - t) * 6;\n    return p;\n};\n// RGBA is [0, 255]\n// HSLA is [0, 1]\nexport var toRgba = function (pixel) {\n    var r;\n    var g;\n    var b;\n    var h = pixel.hue, s = pixel.saturation, l = pixel.lightness, a = pixel.alpha;\n    if (s === 0) {\n        r = g = b = l;\n    }\n    else {\n        var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n        var p = 2 * l - q;\n        r = hue2rgb(p, q, h + 1 / 3);\n        g = hue2rgb(p, q, h);\n        b = hue2rgb(p, q, h - 1 / 3);\n    }\n    var red = to255(r);\n    var green = to255(g);\n    var blue = to255(b);\n    var alpha = to255(a);\n    return { red: red, green: green, blue: blue, alpha: alpha };\n};\nexport var toHsla = function (pixel) {\n    var r = pixel.red, g = pixel.green, b = pixel.blue, a = pixel.alpha;\n    r /= 255;\n    g /= 255;\n    b /= 255;\n    a /= 255;\n    var max = Math.max(r, g, b);\n    var min = Math.min(r, g, b);\n    var middle = (max + min) / 2;\n    var h = middle;\n    var s = middle;\n    var l = middle;\n    if (max === min) {\n        h = s = 0;\n    }\n    else {\n        var d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n        switch (max) {\n            case r:\n                h = (g - b) / d + (g < b ? 6 : 0);\n                break;\n            case g:\n                h = (b - r) / d + 2;\n                break;\n            case b:\n                h = (r - g) / d + 4;\n                break;\n        }\n        h /= 6;\n    }\n    return { hue: h, saturation: s, lightness: s, alpha: a };\n};\nvar RGBA = {\n    channels: 4\n};\nexport var COLOR_PROFILES = {\n    RGBA: RGBA\n};\nvar isEven = function (n) { return n % 2 === 0; };\nvar EMPTY_PIXEL = {\n    red: 0,\n    green: 0,\n    blue: 0,\n    alpha: 255\n};\nexport var vonNeumannOffsets = [\n    { x: -1, y: 0 },\n    { x: 1, y: 0 },\n    { x: 0, y: -1 },\n    { x: 0, y: 1 }\n];\nexport var mooreOffsets = [];\nfor (var x = -1; x <= 1; x++) {\n    for (var y = -1; y <= 1; y++) {\n        if (x === 0 && y === 0) {\n            continue;\n        }\n        mooreOffsets.push({ x: x, y: y });\n    }\n}\nvar PixelMatrix = /** @class */ (function () {\n    function PixelMatrix(width, height, pixels) {\n        this.width = width;\n        this.height = height;\n        var pixelsLength = width * height * this.colorProfile.channels;\n        if (pixels === undefined) {\n            pixels = new Uint8ClampedArray(pixelsLength);\n        }\n        else {\n            if (pixelsLength !== pixels.length) {\n                throw new Error(\"Expected pixels to have length \" + pixelsLength + \" (width * height * colorProfile.channels) but got \" + pixels.length + \" instead.\");\n            }\n        }\n        this.pixels = pixels;\n    }\n    PixelMatrix.fromCanvas = function (canvas) {\n        var context = canvas.getContext('2d');\n        var imageData = context.getImageData(0, 0, canvas.width, canvas.height);\n        return new PixelMatrix(canvas.width, canvas.height, imageData.data);\n    };\n    Object.defineProperty(PixelMatrix.prototype, \"pixelMatrix\", {\n        get: function () {\n            if (!this._pixelMatrix) {\n                var pixelMatrix_1 = new Array(this.width);\n                this.forEach(function (pixel, point) {\n                    if (!pixelMatrix_1[point.x])\n                        pixelMatrix_1[point.x] = [];\n                    pixelMatrix_1[point.x][point.y] = pixel;\n                });\n                this._pixelMatrix = pixelMatrix_1;\n            }\n            return this._pixelMatrix;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PixelMatrix.prototype, \"channels\", {\n        get: function () {\n            return this.colorProfile.channels;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PixelMatrix.prototype, \"colorProfile\", {\n        get: function () {\n            return RGBA;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PixelMatrix.prototype, \"shape\", {\n        get: function () {\n            return [this.width, this.height];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PixelMatrix.prototype, \"countPixels\", {\n        get: function () {\n            return this.width * this.height;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    PixelMatrix.prototype.get = function (point) {\n        if (!this.contains(point)) {\n            throw new Error(\"This pixel matrix doesn't contain the point \" + point + \".\");\n        }\n        var i = this.getIndex(point);\n        var channels = [];\n        for (var channelOffset = 0; channelOffset < this.colorProfile.channels; channelOffset++) {\n            var channel = this.pixels[i + channelOffset];\n            if (!channel)\n                return EMPTY_PIXEL;\n            channels.push(channel);\n        }\n        var red = channels[0], green = channels[1], blue = channels[2], alpha = channels[3];\n        return { red: red, green: green, blue: blue, alpha: alpha };\n    };\n    PixelMatrix.prototype.getRandomPoint = function () {\n        var x = Math.floor(Math.random() * this.width);\n        var y = Math.floor(Math.random() * this.height);\n        return { x: x, y: y };\n    };\n    PixelMatrix.prototype.getRandomPixel = function () {\n        var randomPoint = this.getRandomPoint();\n        return this.get(randomPoint);\n    };\n    PixelMatrix.prototype.getVonNeumannNeighboringPixels = function (point) {\n        return this.getNeighboringPixels(point, vonNeumannOffsets);\n    };\n    PixelMatrix.prototype.getVonNeumannNeighboringPoints = function (point) {\n        return this.getNeighbors(point, vonNeumannOffsets);\n    };\n    PixelMatrix.prototype.getMooreNeighboringPixels = function (point) {\n        return this.getNeighboringPixels(point, mooreOffsets);\n    };\n    PixelMatrix.prototype.getMooreNeighboringPoints = function (point) {\n        return this.getNeighbors(point, mooreOffsets);\n    };\n    PixelMatrix.prototype.getNeighboringPixels = function (point, neighborhood) {\n        var _this = this;\n        return this.getNeighbors(point, neighborhood).map(function (neighbor) {\n            return _this.get(neighbor);\n        });\n    };\n    PixelMatrix.prototype.getNeighbors = function (point, neighborhood) {\n        var _this = this;\n        var neighbors = [];\n        neighborhood.forEach(function (offset) {\n            var neighbor = {\n                x: point.x + offset.x,\n                y: point.y + offset.y\n            };\n            if (_this.contains(neighbor)) {\n                neighbors.push(neighbor);\n            }\n        });\n        return neighbors;\n    };\n    PixelMatrix.prototype.setHsla = function (point, pixel) {\n        this.set(point, toRgba(pixel));\n    };\n    PixelMatrix.prototype.set = function (point, pixel) {\n        var red = pixel.red, green = pixel.green, blue = pixel.blue, alpha = pixel.alpha;\n        var i = this.getIndex(point);\n        this.pixels[i] = red;\n        this.pixels[i + 1] = green;\n        this.pixels[i + 2] = blue;\n        this.pixels[i + 3] = alpha;\n        this.pixelMatrix[point.x][point.y] = pixel;\n    };\n    PixelMatrix.prototype.randomDitherFrom = function (newMatrix, samples) {\n        var _this = this;\n        if (samples === void 0) { samples = 1000; }\n        var _loop_1 = function (_) {\n            var point = this_1.getRandomPoint();\n            var newPixel = newMatrix.get(point);\n            var p = newPixel;\n            var darkeningFactor = 0;\n            if (Math.random() > 0.5) {\n                p = {\n                    red: p.red - darkeningFactor,\n                    green: p.green - darkeningFactor,\n                    blue: p.blue - darkeningFactor,\n                    alpha: 255\n                };\n            }\n            this_1.getVonNeumannNeighboringPoints(point).forEach(function (neighbor) {\n                _this.set(neighbor, p);\n            });\n        };\n        var this_1 = this;\n        for (var _ = 0; _ < samples; _++) {\n            _loop_1(_);\n        }\n    };\n    PixelMatrix.prototype.getIndex = function (point) {\n        var x = point.x, y = point.y;\n        if (!this.contains(point)) {\n            throw new Error(\"Expected x and y to be less than or equal to (\" + this.width + \", \" + this.height + \") but was actually (\" + x + \", \" + y + \")\");\n        }\n        return y * (this.width * this.channels) + x * this.channels;\n    };\n    PixelMatrix.prototype.forEach = function (fn) {\n        for (var y = 0; y < this.height; y++) {\n            for (var x = 0; x < this.width; x++) {\n                var point = Object.freeze({ x: x, y: y });\n                var pixel = this.get(point);\n                fn(pixel, point, this);\n            }\n        }\n    };\n    PixelMatrix.prototype.map = function (fn) {\n        var newPixelMatrix = new PixelMatrix(this.width, this.height);\n        this.forEach(function (pixel, point, pixelMatrix) {\n            var newPixel = fn(pixel, point, pixelMatrix);\n            newPixelMatrix.set(point, newPixel);\n        });\n        return newPixelMatrix;\n    };\n    PixelMatrix.prototype.normalizedMap = function (fn) {\n        var _this = this;\n        return this.map(function (pixel, point, pixelMatrix) {\n            var normalizedPoint = {\n                x: point.x / _this.width,\n                y: point.y / _this.height\n            };\n            return fn(pixel, normalizedPoint, pixelMatrix);\n        });\n    };\n    PixelMatrix.prototype.reduce = function (fn, startingValue) {\n        var total = startingValue;\n        this.forEach(function (pixel, point) {\n            total = fn(total, pixel, point);\n        });\n        return total;\n    };\n    PixelMatrix.prototype.getWindow = function (center, width, height) {\n        if (isEven(width)) {\n            throw new Error(\"Expected an odd window width, but got \" + width);\n        }\n        if (isEven(height)) {\n            throw new Error(\"Expected an odd window height, but got \" + height);\n        }\n        var xRadius = (width - 1) / 2;\n        var yRadius = (height - 1) / 2;\n        var windowMatrix = new PixelMatrix(width, height);\n        for (var yOffset = -yRadius; yOffset <= yRadius; yOffset++) {\n            for (var xOffset = -xRadius; xOffset <= xRadius; xOffset++) {\n                var x = center.x + xOffset;\n                var y = center.y + yOffset;\n                var point = { x: x, y: y };\n                var pixel = this.contains(point) ? this.get(point) : EMPTY_PIXEL;\n                var pointInWindow = { x: xOffset + xRadius, y: yOffset + yRadius };\n                windowMatrix.set(pointInWindow, pixel);\n            }\n        }\n        return windowMatrix;\n    };\n    PixelMatrix.prototype.contains = function (point) {\n        return (point.x >= 0 &&\n            point.x < this.width &&\n            point.y >= 0 &&\n            point.y < this.height);\n    };\n    PixelMatrix.prototype.toImageData = function () {\n        return new ImageData(this.pixels, this.width, this.height);\n    };\n    PixelMatrix.prototype.putPixels = function (canvas) {\n        if (canvas.width !== this.width || canvas.height !== this.height) {\n            throw new Error(\"Expected canvas shape and PixelMatrix shape to be the same, but canvas shape was [\" + canvas.width + \", \" + canvas.height + \"] and PixelMatrix shape was \" + this.shape + \".\");\n        }\n        var context = canvas.getContext('2d');\n        context.putImageData(this.toImageData(), 0, 0);\n    };\n    PixelMatrix.prototype.getCenter = function () {\n        var x = Math.floor(this.width / 2);\n        var y = Math.floor(this.height / 2);\n        return { x: x, y: y };\n    };\n    return PixelMatrix;\n}());\nexport default PixelMatrix;\n"]}]}